#set($id = $ctx.prev.result.id)
#set($typename = "Balance")
#set($owner = $ctx.identity.sub)
#set($defaultGroups = ["Admin"])
#set($data = "$owner:$id:$typename")
#set($balance = 0)
#set($vat = {})
#set($currency = "GBP")
#set($items = [])

#set($input = $vat.put("owed", 0))
#set($input = $vat.put("paid", 0))

{
  "version": "2017-02-28",
  "operation": "PutItem",
  "key" : {
    "id": $util.dynamodb.toDynamoDBJson($id),
    "__typename": $util.dynamodb.toDynamoDBJson($typename)
  },
  "attributeValues": {
    "createdAt": $util.dynamodb.toDynamoDBJson($util.time.nowISO8601()),
    "data": $util.dynamodb.toDynamoDBJson($data),
    "groupsCanAccess": $util.dynamodb.toDynamoDBJson($defaultGroups),
    "owner": $util.dynamodb.toDynamoDBJson($owner),
    "balance": $util.dynamodb.toDynamoDBJson($balance),
    "currency": $util.dynamodb.toDynamoDBJson($currency),
    "items": $util.dynamodb.toDynamoDBJson($items),
    "vat": $util.dynamodb.toDynamoDBJson($vat)
  },
  "condition": {
    "expression": "attribute_not_exists(id)"
  }
}
